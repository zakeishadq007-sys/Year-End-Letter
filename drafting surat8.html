
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>End Year Letter</title>
  <style>
    :root{
      --bg-img: url(background1.jpeg); --bg:#f6d6ff; --envelope:#f2aa8e;
      --flap:#261610; --paper:#ffe6fb; --paper-shadow:#660c4563; --paper-texture: url(paper-texture.jpeg)
      --accent:#ffd7e4; --ink:#550615; --glow: rgba(195, 193, 58, 0.35);
    }
    body{
      margin:auto; min-height:fit-content; min-height:fit-content;
      display:flex; align-items:first baseline; justify-content:center;
      background: radial-gradient(1200px 1200px at 50% 60%, #2e0b38 100%, var(--bg) 35%);
      font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif; color:#fff;
    }
    .scene{
      width: clamp(300px, 90vw, 560px);
      aspect-ratio: 1/1; position:relative;
      filter: drop-shadow(0 18px 40px rgba(0,0,0,.5));
      cursor:auto; touch-action:auto; outline:none;
    }
    .envelope{
      position:absolute; inset: 120px 40px 120px 40px;
      border-radius:10px;
      background: linear-gradient(180deg, var(--envelope) 0%, #e3b9a7 40%, var(--envelope) 100%);
      overflow:visible;
    }
    .envelope::before{
      content:""; position:absolute; inset:auto 0 0 0; height:54%;
      background:
        linear-gradient(135deg, transparent 48%, var(--envelope-shadow) 48.2%) left/50% 100% no-repeat,
        linear-gradient(225deg, transparent 48%, var(--envelope-shadow) 48.2%) right/50% 100% no-repeat;
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      transform-origin:center bottom;
    }
    .flap{
      position:absolute; left:0; right:0; top:0; height:55%;
      background: linear-gradient(180deg, var(--flap) 0%, #b27a67 100%);
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      transform-origin: 50% 0%;
      transition: transform .3s cubic-bezier(.2,.8,.2,1);
      z-index:10; transform: rotateX(90deg);
    }
    .stamp{
      position:absolute; left:37%; top: 38%;
      width:150px; height:150px; border-radius:50%; overflow:hidden;
      box-shadow: 0 3px 0 rgba(0, 0, 0, 0);
      transform: rotate(0deg); z-index:100; display:flexbox; align-items:flex-end; justify-content:right;
    }
    .stamp img{ width:100%; height:100%; object-fit:fill; display:flex; }

    .paper{
      position:fixed; left:10%; right:10%; bottom:12%; height:64%;
      background: linear-gradient(180deg, var(--paper) 0%, #fce5ff 50%, var(--paper) 100%);
      border-radius:8px;
      box-shadow: 0 6px 16px rgba(0,0,0,.25), inset 0 -10px 30px var(--paper-shadow);
      z-index:2; padding: clamp(14px, 4vw, 24px); color: var(--ink);
      transform: translateY(30%) scale(.98); opacity:0;
      transition:all opacity .5s ease;
    }
    
    .paper h3{ margin:0 0 8px; font-size: clamp(20px, 3.5vw, 22px); }
    .paper p{ font-size: clamp(14px, 3vw, 18px); line-height:2; }

    .hint{
      position:absolute; inset:auto 0 4% 0; text-align:center;
      font-size: clamp(12px, 2.8vw, 14px); color:#e6d7ff; opacity:.9;
      user-select:none; pointer-events:none; z-index:7;
    }

    /* Kontrol audio sederhana */
    .controls{
      position:absolute; top:6%; right:8%;
      display:flex; gap:8px; z-index:8;
    }
    
    .btn{
      background: rgba(255,255,255,.18);
      color:#fff; border:1px solid rgba(255,255,255,.25);
      padding:6px 10px; border-radius:8px; font-size:12px;
      backdrop-filter: blur(4px);
    }

    /* State */
    .scene.open .flap{  transform: rotateX(90deg); }
    .scene.open .paper{ transform: translateY(-10%) scale(1); opacity:1; overflow:scroll;}
    .scene.open .stamp{ transform: translateY(30%) scale(.98); opacity:0; }
    .scene.close .flap{ transform: rotateX(0deg); }
    .scene.close .paper{ transform: translateY(30%) scale(.98); opacity:0; }
    .scene[role="button"]:focus{ outline:2px dashed #ffd766; outline-offset:8px; }
  </style>
</head>
<body>

  <div class="scene close" id="scene" role="button" tabindex="0" aria-label="Ketuk untuk membuka atau menutup amplop">
    <div class="envelope">
      <div class="flap"></div>

      <!-- Stamp bergambar (pakai gambar pita pink kamu) -->
      <div class="stamp">
        <img src="stamp.png" alt="Stamp" /> <!-- Preload gambar stamp -->
      </div>

      <div class="paper">
        <h3>Halooo nicholaassssapuutraaaa!!</h3>
        <hr />
        <p>Well, first.. I hope this so-called letter running well at you. 
        I know this is kinda weird, writing a letter in 2025, but hey, why not?
        I just want to say thank you for being such an amazing friend throughout this year. 
        <p>
        Our red string begins when I borrowed you my umbrella to handle panasnya PKKMB.. and I never thought we've been these far.
        You showing what's your true colors, being there when I need someone to talk to, and just being you.
        I really appreciate our friendship, and I hope we can keep this bond strong in the years to come.
        Wishing you all the best for the new year ahead! May it be filled with joy, success, and lots of memorable moments.  
        </p>
        <p>
        Untuk aku yang masih sering bingung apasih yang mau aku lakuin, thank you for realizing me, that it's okay to not have everything figured out yet.
        Makasih udh mau "baca" aku, dengerin curhatanku yang kadang suka random, dan ngasih aku perspektif baru.
        Actually, there are still a lot of your questions that I haven't answered yet, but I promise I'll get to them when I'm ready.
        So, here's to another year of friendship, laughter, and unforgettable memories.
        Semoga kita kedepannya masih bisa bareng dengan segala ups and downsnya.
        Yeah, that's all I can say and let me keep the rest in my du'a.
        </p>
        <p style="text-align:right;">Sincerely,<br />@zakeishadq</p>
      </div>
    </div>

    <div class="hint">Ketuk untuk BUKA â€” ketuk lagi untuk TUTUP</div>

    <!-- Kontrol audio -->
    <div class="controls" aria-label="Kontrol audio">
      <button class="btn" id="btnMute">Mute</button>
      <button class="btn" id="btnLoop">Loop: Off</button>
    </div>
  </div>

  <!-- Audio: ganti src ke file musikmu -->
    <audio id="music" preload="auto"> 
        <source src="Olivia Dean - A Couple Minutes.mp3" type="audio/mpeg">
    </audio>

  <script>
    const scene   = document.getElementById('scene');
    const music   = document.getElementById('music');
    const btnMute = document.getElementById('btnMute');
    const btnLoop = document.getElementById('btnLoop');

    // Set volume awal (0.6 = 60%)
    music.volume = 0.6;

    function playMusicSafe(){
      // Di mobile, playback harus dimulai setelah gesture.
      // Tangani promise play() untuk error (mis. belum di-gesture atau file belum siap).
      music.play().catch(err => {
        console.warn('Tidak bisa memutar audio sekarang:', err);
      });
    }
    function pauseMusic(){
      music.pause();
      // Reset ke awal kalau mau saat ditutup
      // music.currentTime = 0;
    }

    function toggleEnvelope(){
      const opened = scene.classList.contains('open');
      if (opened) {
        scene.classList.remove('open');
        scene.classList.add('close');
        pauseMusic();
      } else {
        scene.classList.remove('close');
        scene.classList.add('open');
        playMusicSafe();
      }
    }

    // Gunakan pointerdown (menangkap mouse + touch)
    scene.addEventListener('pointerdown', toggleEnvelope);
    // Fallback untuk browser lama
    scene.addEventListener('touchstart', toggleEnvelope, { passive:true });
    scene.addEventListener('click', toggleEnvelope);

    // Keyboard (Enter/Space)
    scene.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleEnvelope(); }
    });

    // Kontrol mute
    btnMute.addEventListener('click', () => {
      music.muted = !music.muted;
      btnMute.textContent = music.muted ? 'Unmute' : 'Mute';
    });

    // Kontrol loop
    btnLoop.addEventListener('click', () => {
      music.loop = !music.loop;
      btnLoop.textContent = `Loop: ${music.loop ? 'On' : 'Off'}`;
    });

    // Opsional: auto-mute di awal untuk hindari blokir autoplay
    // music.muted = true; // lalu unmute saat buka jika ingin
  </script>

</body>
</html>